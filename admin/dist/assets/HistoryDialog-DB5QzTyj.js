import{_ as de,aI as ce,b as T,w as s,aK as ve,o as h,a as v,aF as me,aL as pe,c as D,F as J,a0 as R,aG as ee,f as L,b7 as he,j as g,t as z,b8 as ge,b9 as ye,an as Ce,ao as G,ap as we,aq as P,ba as _e,d as U,bb as A,bc as te,ar as $,ay as ne,a2 as re,h as ae,bd as Ve,i as Le}from"../index.js";const Te={props:{item:{type:Object,required:!0}},setup(){return{drawer:ce()}},computed:{values(){const t={id:this.item.id,editor:this.item.editor};return this.item.created_at&&(t.created=new Date(this.item.created_at).toLocaleString()),this.item.updated_at&&(t.updated=new Date(this.item.updated_at).toLocaleString()),this.item.deleted_at&&(t.deleted=new Date(this.item.deleted_at).toLocaleString()),t}}};function De(t,e,n,a,l,r){return h(),T(ve,{modelValue:a.drawer.aside,"onUpdate:modelValue":e[0]||(e[0]=i=>a.drawer.aside=i),"mobile-breakpoint":"md",location:"end"},{default:s(()=>[v(me,{opened:[0]},{default:s(()=>[v(pe,{value:0},{activator:s(({props:i})=>[v(ee,ge(ye(i)),{default:s(()=>e[1]||(e[1]=[g("Meta data")])),_:2,__:[1]},1040)]),default:s(()=>[(h(!0),D(J,null,R(r.values,(i,o)=>(h(),T(ee,{key:o,rounded:"lg"},{default:s(()=>[v(he,{class:"name"},{default:s(()=>[g(z(o),1)]),_:2},1024),L("div",null,z(i),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])}const Me=de(Te,[["render",De],["__scopeId","data-v-051f884b"]]);function y(){}y.prototype={diff:function(e,n){var a,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=l.callback;typeof l=="function"&&(r=l,l={});var i=this;function o(c){return c=i.postProcess(c,l),r?(setTimeout(function(){r(c)},0),!0):c}e=this.castInput(e,l),n=this.castInput(n,l),e=this.removeEmpty(this.tokenize(e,l)),n=this.removeEmpty(this.tokenize(n,l));var u=n.length,d=e.length,f=1,m=u+d;l.maxEditLength!=null&&(m=Math.min(m,l.maxEditLength));var _=(a=l.timeout)!==null&&a!==void 0?a:1/0,w=Date.now()+_,p=[{oldPos:-1,lastComponent:void 0}],C=this.extractCommon(p[0],n,e,0,l);if(p[0].oldPos+1>=d&&C+1>=u)return o(ie(i,p[0].lastComponent,n,e,i.useLongestToken));var I=-1/0,k=1/0;function x(){for(var c=Math.max(I,-f);c<=Math.min(k,f);c+=2){var V=void 0,O=p[c-1],N=p[c+1];O&&(p[c-1]=void 0);var H=!1;if(N){var S=N.oldPos-c;H=N&&0<=S&&S<u}var K=O&&O.oldPos+1<d;if(!H&&!K){p[c]=void 0;continue}if(!K||H&&O.oldPos<N.oldPos?V=i.addToPath(N,!0,!1,0,l):V=i.addToPath(O,!1,!0,1,l),C=i.extractCommon(V,n,e,c,l),V.oldPos+1>=d&&C+1>=u)return o(ie(i,V.lastComponent,n,e,i.useLongestToken));p[c]=V,V.oldPos+1>=d&&(k=Math.min(k,c-1)),C+1>=u&&(I=Math.max(I,c+1))}f++}if(r)(function c(){setTimeout(function(){if(f>m||Date.now()>w)return r();x()||c()},0)})();else for(;f<=m&&Date.now()<=w;){var M=x();if(M)return M}},addToPath:function(e,n,a,l,r){var i=e.lastComponent;return i&&!r.oneChangePerToken&&i.added===n&&i.removed===a?{oldPos:e.oldPos+l,lastComponent:{count:i.count+1,added:n,removed:a,previousComponent:i.previousComponent}}:{oldPos:e.oldPos+l,lastComponent:{count:1,added:n,removed:a,previousComponent:i}}},extractCommon:function(e,n,a,l,r){for(var i=n.length,o=a.length,u=e.oldPos,d=u-l,f=0;d+1<i&&u+1<o&&this.equals(a[u+1],n[d+1],r);)d++,u++,f++,r.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return f&&!r.oneChangePerToken&&(e.lastComponent={count:f,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=u,d},equals:function(e,n,a){return a.comparator?a.comparator(e,n):e===n||a.ignoreCase&&e.toLowerCase()===n.toLowerCase()},removeEmpty:function(e){for(var n=[],a=0;a<e.length;a++)e[a]&&n.push(e[a]);return n},castInput:function(e){return e},tokenize:function(e){return Array.from(e)},join:function(e){return e.join("")},postProcess:function(e){return e}};function ie(t,e,n,a,l){for(var r=[],i;e;)r.push(e),i=e.previousComponent,delete e.previousComponent,e=i;r.reverse();for(var o=0,u=r.length,d=0,f=0;o<u;o++){var m=r[o];if(m.removed)m.value=t.join(a.slice(f,f+m.count)),f+=m.count;else{if(!m.added&&l){var _=n.slice(d,d+m.count);_=_.map(function(w,p){var C=a[f+p];return C.length>w.length?C:w}),m.value=t.join(_)}else m.value=t.join(n.slice(d,d+m.count));d+=m.count,m.added||(f+=m.count)}}return r}function le(t,e){var n;for(n=0;n<t.length&&n<e.length;n++)if(t[n]!=e[n])return t.slice(0,n);return t.slice(0,n)}function ue(t,e){var n;if(!t||!e||t[t.length-1]!=e[e.length-1])return"";for(n=0;n<t.length&&n<e.length;n++)if(t[t.length-(n+1)]!=e[e.length-(n+1)])return t.slice(-n);return t.slice(-n)}function Z(t,e,n){if(t.slice(0,e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't start with prefix ").concat(JSON.stringify(e),"; this is a bug"));return n+t.slice(e.length)}function Q(t,e,n){if(!e)return t+n;if(t.slice(-e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't end with suffix ").concat(JSON.stringify(e),"; this is a bug"));return t.slice(0,-e.length)+n}function q(t,e){return Z(t,e,"")}function B(t,e){return Q(t,e,"")}function oe(t,e){return e.slice(0,ze(t,e))}function ze(t,e){var n=0;t.length>e.length&&(n=t.length-e.length);var a=e.length;t.length<e.length&&(a=t.length);var l=Array(a),r=0;l[0]=0;for(var i=1;i<a;i++){for(e[i]==e[r]?l[i]=l[r]:l[i]=r;r>0&&e[i]!=e[r];)r=l[r];e[i]==e[r]&&r++}r=0;for(var o=n;o<t.length;o++){for(;r>0&&t[o]!=e[r];)r=l[r];t[o]==e[r]&&r++}return r}var F="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",Ee=new RegExp("[".concat(F,"]+|\\s+|[^").concat(F,"]"),"ug"),b=new y;b.equals=function(t,e,n){return n.ignoreCase&&(t=t.toLowerCase(),e=e.toLowerCase()),t.trim()===e.trim()};b.tokenize=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n;if(e.intlSegmenter){if(e.intlSegmenter.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');n=Array.from(e.intlSegmenter.segment(t),function(r){return r.segment})}else n=t.match(Ee)||[];var a=[],l=null;return n.forEach(function(r){/\s/.test(r)?l==null?a.push(r):a.push(a.pop()+r):/\s/.test(l)?a[a.length-1]==l?a.push(a.pop()+r):a.push(l+r):a.push(r),l=r}),a};b.join=function(t){return t.map(function(e,n){return n==0?e:e.replace(/^\s+/,"")}).join("")};b.postProcess=function(t,e){if(!t||e.oneChangePerToken)return t;var n=null,a=null,l=null;return t.forEach(function(r){r.added?a=r:r.removed?l=r:((a||l)&&se(n,l,a,r),n=r,a=null,l=null)}),(a||l)&&se(n,l,a,null),t};function se(t,e,n,a){if(e&&n){var l=e.value.match(/^\s*/)[0],r=e.value.match(/\s*$/)[0],i=n.value.match(/^\s*/)[0],o=n.value.match(/\s*$/)[0];if(t){var u=le(l,i);t.value=Q(t.value,i,u),e.value=q(e.value,u),n.value=q(n.value,u)}if(a){var d=ue(r,o);a.value=Z(a.value,o,d),e.value=B(e.value,d),n.value=B(n.value,d)}}else if(n)t&&(n.value=n.value.replace(/^\s*/,"")),a&&(a.value=a.value.replace(/^\s*/,""));else if(t&&a){var f=a.value.match(/^\s*/)[0],m=e.value.match(/^\s*/)[0],_=e.value.match(/\s*$/)[0],w=le(f,m);e.value=q(e.value,w);var p=ue(q(f,w),_);e.value=B(e.value,p),a.value=Z(a.value,f,p),t.value=Q(t.value,f,f.slice(0,f.length-p.length))}else if(a){var C=a.value.match(/^\s*/)[0],I=e.value.match(/\s*$/)[0],k=oe(I,C);e.value=B(e.value,k)}else if(t){var x=t.value.match(/\s*$/)[0],M=e.value.match(/^\s*/)[0],c=oe(x,M);e.value=q(e.value,c)}}var Ie=new y;Ie.tokenize=function(t){var e=new RegExp("(\\r?\\n)|[".concat(F,"]+|[^\\S\\n\\r]+|[^").concat(F,"]"),"ug");return t.match(e)||[]};var W=new y;W.tokenize=function(t,e){e.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));var n=[],a=t.split(/(\n|\r\n)/);a[a.length-1]||a.pop();for(var l=0;l<a.length;l++){var r=a[l];l%2&&!e.newlineIsToken?n[n.length-1]+=r:n.push(r)}return n};W.equals=function(t,e,n){return n.ignoreWhitespace?((!n.newlineIsToken||!t.includes(`
`))&&(t=t.trim()),(!n.newlineIsToken||!e.includes(`
`))&&(e=e.trim())):n.ignoreNewlineAtEof&&!n.newlineIsToken&&(t.endsWith(`
`)&&(t=t.slice(0,-1)),e.endsWith(`
`)&&(e=e.slice(0,-1))),y.prototype.equals.call(this,t,e,n)};var ke=new y;ke.tokenize=function(t){return t.split(/(\S.+?[.!?])(?=\s+|$)/)};var Oe=new y;Oe.tokenize=function(t){return t.split(/([{}:;,]|\s+)/)};function X(t){"@babel/helpers - typeof";return X=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},X(t)}var E=new y;E.useLongestToken=!0;E.tokenize=W.tokenize;E.castInput=function(t,e){var n=e.undefinedReplacement,a=e.stringifyReplacer,l=a===void 0?function(r,i){return typeof i>"u"?n:i}:a;return typeof t=="string"?t:JSON.stringify(Y(t,null,null,l),l,"  ")};E.equals=function(t,e,n){return y.prototype.equals.call(E,t.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"),n)};function fe(t,e,n){return E.diff(t,e,n)}function Y(t,e,n,a,l){e=e||[],n=n||[],a&&(t=a(l,t));var r;for(r=0;r<e.length;r+=1)if(e[r]===t)return n[r];var i;if(Object.prototype.toString.call(t)==="[object Array]"){for(e.push(t),i=new Array(t.length),n.push(i),r=0;r<t.length;r+=1)i[r]=Y(t[r],e,n,a,l);return e.pop(),n.pop(),i}if(t&&t.toJSON&&(t=t.toJSON()),X(t)==="object"&&t!==null){e.push(t),i={},n.push(i);var o=[],u;for(u in t)Object.prototype.hasOwnProperty.call(t,u)&&o.push(u);for(o.sort(),r=0;r<o.length;r+=1)u=o[r],i[u]=Y(t[u],e,n,a,u);e.pop(),n.pop()}else i=t;return i}var j=new y;j.tokenize=function(t){return t.slice()};j.join=j.removeEmpty=function(t){return t};const Ne={props:{modelValue:{type:Boolean,required:!0},current:{type:Object,required:!0},load:{type:Function,required:!0}},emit:["update:modelValue","use","revert"],data:()=>({list:[],latest:null,loading:!1,show:!1}),computed:{versions(){return this.list.filter(t=>this.isModified(t,this.current)||t.published||t.publish_at)}},methods:{diff(t,e){return t&&e?fe(t,e):e?[e]:[]},isModified(t,e){return!t||!e?!1:fe(t.data||{},e.data||{}).length!==1},reset(){this.list=[],this.latest=null}},watch:{modelValue:{immediate:!0,handler(t){t&&!this.latest&&(this.loading=!0,this.load().then(e=>{this.latest=e.shift(),this.list=e}).finally(()=>{this.loading=!1}))}}}},$e=["onClick"];function qe(t,e,n,a,l,r){return h(),T(Ce,{modelValue:n.modelValue,"max-width":"1200",scrollable:""},{default:s(()=>[v(G,{"prepend-icon":"mdi-history"},{append:s(()=>[v(Le,{onClick:e[0]||(e[0]=i=>t.$emit("update:modelValue",!1))},{default:s(()=>e[3]||(e[3]=[g("mdi-close")])),_:1,__:[3]})]),title:s(()=>e[4]||(e[4]=[g(" History ")])),default:s(()=>[v(we),v(P,null,{default:s(()=>[v(_e,{side:"end",align:"start"},{default:s(()=>[t.loading?(h(),T(A,{key:0,size:"small","dot-color":"grey-lighten-1"},{default:s(()=>e[5]||(e[5]=[L("div",{class:"loading"},[g(" Loading "),L("svg",{class:"spinner",width:"32",height:"32",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[L("circle",{class:"spin1",cx:"4",cy:"12",r:"3"}),L("circle",{class:"spin1 spin2",cx:"12",cy:"12",r:"3"}),L("circle",{class:"spin1 spin3",cx:"20",cy:"12",r:"3"})])],-1)])),_:1,__:[5]})):U("",!0),!t.loading&&!(t.latest&&r.isModified(t.latest,n.current)||r.versions.length)?(h(),T(A,{key:1,size:"small","dot-color":"grey-lighten-1"},{default:s(()=>e[6]||(e[6]=[g(" No changes ")])),_:1,__:[6]})):U("",!0),!t.loading&&t.latest&&r.isModified(t.latest,n.current)?(h(),T(A,{key:2,size:"small","dot-color":"blue"},{default:s(()=>[v(G,{class:"elevation-2",onClick:e[2]||(e[2]=i=>t.show=!t.show)},{default:s(()=>[v(te,null,{default:s(()=>e[7]||(e[7]=[g("Current")])),_:1,__:[7]}),v(P,{class:$(["diff",{show:t.show}])},{default:s(()=>{var i;return[(h(!0),D(J,null,R(r.diff(n.current.data,(i=t.latest)==null?void 0:i.data),o=>(h(),D("span",{class:$({added:o.added,removed:o.removed})},z(o.value||o),3))),256))]}),_:1},8,["class"]),v(ne,null,{default:s(()=>[v(re,{variant:"outlined",onClick:e[1]||(e[1]=ae(i=>t.$emit("revert",t.latest),["stop"]))},{default:s(()=>e[8]||(e[8]=[g(" Revert ")])),_:1,__:[8]})]),_:1})]),_:1})]),_:1})):U("",!0),(h(!0),D(J,null,R(r.versions,(i,o)=>(h(),T(A,{key:o,size:"small","dot-color":i.published?"success":"grey-lighten-1",class:$({publish:i.publish_at})},{default:s(()=>[v(G,{class:"elevation-2"},{default:s(()=>[L("div",{onClick:u=>i._show=!i._show},[v(te,null,{default:s(()=>[g(z(new Date(i.publish_at||i.created_at).toLocaleString()),1)]),_:2},1024),v(Ve,null,{default:s(()=>[g(z(i.editor),1)]),_:2},1024),v(P,{class:$(["diff",{show:i._show}])},{default:s(()=>[(h(!0),D(J,null,R(r.diff(i.data,n.current.data),u=>(h(),D("span",{class:$({added:u.removed,removed:u.added})},z(u.value||u),3))),256))]),_:2},1032,["class"])],8,$e),v(ne,null,{default:s(()=>[v(re,{variant:"outlined",onClick:ae(u=>t.$emit("use",i),["stop"])},{default:s(()=>e[9]||(e[9]=[g(" Use version ")])),_:2,__:[9]},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["dot-color","class"]))),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}const Ae=de(Ne,[["render",qe],["__scopeId","data-v-0a8d7f78"]]);export{Me as A,Ae as H};
