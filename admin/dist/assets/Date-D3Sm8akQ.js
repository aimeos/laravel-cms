import{p as J,L as H,M as j,n as ne,N as le,O as re,u as E,s as L,P as N,q as S,Q as oe,R as ue,v as ie,S as se,x as M,y as de,z as ce,A as fe,U as me,W as ve,C as T,X as q,E as Y,a as I,G as $,Y as ye,f as pe,H as he,F as Ve,_ as ge,b as Pe,r as De,o as Fe}from"../index.js";class P{constructor(n,a){this.order=n,this.separator=a}get format(){return this.order.split("").map(n=>`${n}${n}`).join(this.separator).replace("yy","yyyy")}static canBeParsed(n){if(typeof n!="string")return!1;const a=n.toLowerCase();return["y","m","d"].every(r=>a.includes(r))&&["/","-","."].some(r=>n.includes(r))}static parse(n){if(!P.canBeParsed(n))throw new Error(`[${n}] cannot be parsed into date format specification`);const a=n.toLowerCase().split("").filter((u,p,l)=>"dmy".includes(u)&&l.indexOf(u)===p).join(""),r=["/","-","."].find(u=>n.includes(u));return new P(a,r)}}const we=J({inputFormat:{type:String,validator:e=>!e||P.canBeParsed(e)}},"date-format");function ke(e,n){const a=H();function r(){const f=n.value??"en-US",V=Intl.DateTimeFormat(f,{year:"numeric",month:"2-digit",day:"2-digit"}).format(a.toJsDate(a.parseISO("1999-12-07"))).replace(/(07)|(٠٧)|(٢٩)|(۱۶)|(০৭)/,"dd").replace(/(12)|(١٢)|(٠٨)|(۰۹)|(১২)/,"mm").replace(/(1999)|(2542)|(١٩٩٩)|(١٤٢٠)|(۱۳۷۸)|(১৯৯৯)/,"yyyy").replace(/[^ymd\-/.]/g,"").replace(/\.$/,"");return P.canBeParsed(V)?V:"mm/dd/yyyy"}const u=j(()=>P.canBeParsed(e.inputFormat)?P.parse(e.inputFormat):P.parse(r()));function p(f){function V(i){const d=i.trim().split(u.value.separator);return{y:Number(d[u.value.order.indexOf("y")]),m:Number(d[u.value.order.indexOf("m")]),d:Number(d[u.value.order.indexOf("d")])}}function b(i){const{y:d,m:y,d:k}=i;return!d||!y||!k||y<1||y>12||k<1||k>31?null:{year:w(d),month:y,day:k}}function w(i){const d=a.getYear(a.date());if(i>100||d%100>=50)return i;const y=~~(d/100)*100;return i<50?y+i:y-100+i}const O=V(f),o=b(O);if(!o)return null;const{year:s,month:v,day:D}=o,C=i=>String(i).padStart(2,"0");return a.parseISO(`${s}-${C(v)}-${C(D)}`)}function l(f){return!!p(f)}function h(f){const V=a.toISO(f).split("-");return u.value.order.split("").map(b=>V["ymd".indexOf(b)]).join(u.value.separator)}return{isValid:l,parseDate:p,formatDate:h,parserFormat:j(()=>u.value.format)}}const xe=J({displayFormat:[Function,String],location:{type:String,default:"bottom start"},menu:Boolean,updateOn:{type:Array,default:()=>["blur","enter"]},...we(),...me({mobile:null}),...fe(),...ce({hideActions:!0}),...de({prependIcon:"$calendar"}),...M(ve({hideHeader:!0,showAdjacentMonths:!0}),["active","location","rounded"])},"VDateInput"),be=ne()({name:"VDateInput",props:xe(),emits:{save:e=>!0,cancel:()=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,n){let{emit:a,slots:r}=n;const{t:u,current:p}=le(),l=H(),{isValid:h,parseDate:f,formatDate:V,parserFormat:b}=ke(e,p),{mobile:w}=re(e),O=()=>e.multiple?[]:null,o=E(e,"modelValue",O(),t=>Array.isArray(t)?t.map(c=>l.toJsDate(c)):t&&l.toJsDate(t),t=>Array.isArray(t)?t.map(c=>l.date(c)):t&&l.date(t)),s=E(e,"menu"),v=L(!1),D=L(e.focused),C=N(),i=N(["save"]);function d(t){return typeof e.displayFormat=="function"?e.displayFormat(t):e.displayFormat?l.format(t,e.displayFormat??"keyboardDate"):V(t)}const y=S(()=>{const t=oe(o.value);if(!t.length)return null;if(e.multiple===!0)return u("$vuetify.datePicker.itemsSelected",t.length);if(e.multiple==="range"){const c=t[0],g=t[t.length-1];return!l.isValid(c)||!l.isValid(g)?"":`${d(l.date(c))} - ${d(l.date(g))}`}return l.isValid(o.value)?d(l.date(o.value)):""}),k=S(()=>{if(w.value)return v.value?"text":"none"}),B=S(()=>!e.disabled&&!e.readonly),K=S(()=>e.updateOn.length?!(w.value&&v.value)&&e.readonly:!0);ue(s,t=>{t||(v.value=!1,i.value=["save"])});function z(t){t.key==="Enter"&&((!s.value||!D.value)&&(s.value=!0),e.updateOn.includes("enter")&&_(t.target))}function R(t){t.preventDefault(),t.stopPropagation(),s.value&&w.value?v.value=!0:s.value=!0}function G(){a("cancel"),s.value=!1,v.value=!1}function Q(t){a("save",t),s.value=!1}function W(t){t==null&&(o.value=O())}function X(t){e.updateOn.includes("blur")&&_(t.target),w.value&&v.value&&!D.value&&(s.value=!1,v.value=!1)}function _(t){let{value:c}=t;if(!c.trim())o.value=O();else if(!e.multiple)h(c)&&(o.value=f(c));else{const g=c.trim().split(/\D+-\D+|[^\d\-/.]+/);if(g.every(h))if(e.multiple==="range"){const[x,F]=g.map(f).toSorted((U,A)=>l.isAfter(U,A)?1:-1);o.value=ye(l,x,F)}else o.value=g.map(f)}}return ie(()=>{const t=T.filterProps(e),c=q.filterProps(M(e,["active","location","rounded"])),g=Y.filterProps(M(e,["placeholder"]));return I(Y,$({ref:C},g,{class:e.class,style:e.style,modelValue:y.value,inputmode:k.value,placeholder:e.placeholder??b.value,readonly:K.value,onKeydown:B.value?z:void 0,focused:s.value||D.value,onBlur:X,validationValue:o.value,"onClick:control":B.value?R:void 0,"onClick:prepend":B.value?R:void 0,"onUpdate:modelValue":W,"onUpdate:focused":x=>D.value=x}),{...r,default:()=>{var x;return pe(Ve,null,[I(he,{modelValue:s.value,"onUpdate:modelValue":F=>s.value=F,activator:"parent","min-width":"0",eager:D.value,location:e.location,closeOnContentClick:!1,openOnClick:!1},{default:()=>[I(T,$(t,{modelValue:o.value,"onUpdate:modelValue":F=>o.value=F,disabled:i.value,onSave:Q,onCancel:G}),{default:F=>{let{actions:U,model:A,save:Z,cancel:ee,isPristine:te}=F;function ae(m){e.hideActions?(o.value=m,e.multiple||(s.value=!1)):A.value=m,a("save",m),i.value=[]}return I(q,$(c,{modelValue:e.hideActions?o.value:A.value,"onUpdate:modelValue":m=>ae(m),onMousedown:m=>m.preventDefault()}),{actions:e.hideActions?void 0:()=>{var m;return((m=r.actions)==null?void 0:m.call(r,{save:Z,cancel:ee,isPristine:te}))??U()}})}})]}),(x=r.default)==null?void 0:x.call(r)])}})}),se({},C)}}),Oe={components:{VDateInput:be},props:{modelValue:{type:[Array,Date,String,null],default:null},config:{type:Object,default:()=>{}},assets:{type:Object,default:()=>{}},readonly:{type:Boolean,default:!1}},emits:["update:modelValue","error"],methods:{update(e){this.$emit("update:modelValue",e),this.validate()},async validate(){await this.$nextTick();const e=await this.$refs.field.validate();return this.$emit("error",e.length>0),!e.length}},watch:{modelValue:{immediate:!0,handler(e){this.validate()}}}};function Ce(e,n,a,r,u,p){const l=De("v-date-input");return Fe(),Pe(l,{ref:"field",rules:[h=>!a.config.required||!!h||e.$gettext("Value is required")],readonly:a.readonly,"allowed-dates":a.config.allowed,clearable:!a.readonly&&!a.config.required,max:a.config.max,min:a.config.min,multiple:a.config.multiple,placeholder:a.config.placeholder||null,modelValue:a.modelValue,"onUpdate:modelValue":n[0]||(n[0]=h=>p.update(h)),density:"comfortable","hide-details":"auto",variant:"outlined","show-adjacent-months":""},null,8,["rules","readonly","allowed-dates","clearable","max","min","multiple","placeholder","modelValue"])}const Se=ge(Oe,[["render",Ce]]);export{Se as default};
