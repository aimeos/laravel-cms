import{p as J,K,L as j,l as le,M as oe,N as ue,u as ie,m as E,s as se,O as L,n as A,P as de,Q as ce,q as fe,R as me,v as M,S as ve,x as ye,y as pe,z as he,U as ge,B as N,W as T,D as q,a as b,E as U,X as Ve,F as De,G as Pe,_ as Fe,b as we,r as ke,o as xe}from"../index.js";class P{constructor(n,a){this.order=n,this.separator=a}get format(){return this.order.split("").map(n=>`${n}${n}`).join(this.separator).replace("yy","yyyy")}static canBeParsed(n){if(typeof n!="string")return!1;const a=n.toLowerCase();return["y","m","d"].every(u=>a.includes(u))&&["/","-","."].some(u=>n.includes(u))}static parse(n){if(!P.canBeParsed(n))throw new Error(`[${n}] cannot be parsed into date format specification`);const a=n.toLowerCase().split("").filter((i,h,r)=>"dmy".includes(i)&&r.indexOf(i)===h).join(""),u=["/","-","."].find(i=>n.includes(i));return new P(a,u)}}const be=J({inputFormat:{type:String,validator:e=>!e||P.canBeParsed(e)}},"date-format");function Oe(e,n){const a=K();function u(){const f=n.value??"en-US",V=Intl.DateTimeFormat(f,{year:"numeric",month:"2-digit",day:"2-digit"}).format(a.toJsDate(a.parseISO("1999-12-07"))).replace(/(07)|(٠٧)|(٢٩)|(۱۶)|(০৭)/,"dd").replace(/(12)|(١٢)|(٠٨)|(۰۹)|(১২)/,"mm").replace(/(1999)|(2542)|(١٩٩٩)|(١٤٢٠)|(۱۳۷۸)|(১৯৯৯)/,"yyyy").replace(/[^ymd\-/.]/g,"").replace(/\.$/,"");return P.canBeParsed(V)?V:"mm/dd/yyyy"}const i=j(()=>P.canBeParsed(e.inputFormat)?P.parse(e.inputFormat):P.parse(u()));function h(f){function V(l){const c=l.trim().split(i.value.separator);return{y:Number(c[i.value.order.indexOf("y")]),m:Number(c[i.value.order.indexOf("m")]),d:Number(c[i.value.order.indexOf("d")])}}function k(l){const{y:c,m,d:D}=l;return!c||!m||!D||m<1||m>12||D<1||D>31?null:{year:F(c),month:m,day:D}}function F(l){const c=a.getYear(a.date());if(l>100||c%100>=50)return l;const m=~~(c/100)*100;return l<50?m+l:m-100+l}const w=V(f),O=k(w);if(!O)return null;const{year:S,month:x,day:s}=O,d=l=>String(l).padStart(2,"0");return a.parseISO(`${S}-${d(x)}-${d(s)}`)}function r(f){return!!h(f)}function g(f){const V=a.toISO(f).split("-");return i.value.order.split("").map(k=>V["ymd".indexOf(k)]).join(i.value.separator)}return{isValid:r,parseDate:h,formatDate:g,parserFormat:j(()=>i.value.format)}}const Ce=J({displayFormat:[Function,String],location:{type:String,default:"bottom start"},menu:Boolean,updateOn:{type:Array,default:()=>["blur","enter"]},...be(),...ge({mobile:null}),...he(),...pe({hideActions:!0}),...ye({prependIcon:"$calendar"}),...M(ve({hideHeader:!0,showAdjacentMonths:!0}),["active","location","rounded"])},"VDateInput"),Ae=le()({name:"VDateInput",props:Ce(),emits:{save:e=>!0,cancel:()=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,n){let{emit:a,slots:u}=n;const{t:i,current:h}=oe(),r=K(),{isValid:g,parseDate:f,formatDate:V,parserFormat:k}=Oe(e,h),{mobile:F}=ue(e),{isFocused:w,focus:O,blur:S}=ie(e),x=()=>e.multiple?[]:null,s=E(e,"modelValue",x(),t=>Array.isArray(t)?t.map(o=>r.toJsDate(o)):t&&r.toJsDate(t),t=>Array.isArray(t)?t.map(o=>r.date(o)):t&&r.date(t)),d=E(e,"menu"),l=se(!1),c=L(),m=L(["save"]);function D(t){return typeof e.displayFormat=="function"?e.displayFormat(t):e.displayFormat?r.format(t,e.displayFormat??"keyboardDate"):V(t)}const Y=A(()=>{const t=de(s.value);if(!t.length)return null;if(e.multiple===!0)return i("$vuetify.datePicker.itemsSelected",t.length);if(e.multiple==="range"){const o=t[0],v=t[t.length-1];return!r.isValid(o)||!r.isValid(v)?"":`${D(r.date(o))} - ${D(r.date(v))}`}return r.isValid(s.value)?D(r.date(s.value)):""}),z=A(()=>{if(F.value)return l.value?"text":"none"}),I=A(()=>!e.disabled&&!e.readonly),G=A(()=>e.updateOn.length?!(F.value&&l.value)&&e.readonly:!0);ce(d,t=>{t||(l.value=!1,m.value=["save"])});function H(t){t.key==="Enter"&&((!d.value||!w.value)&&(d.value=!0),e.updateOn.includes("enter")&&_(t.target))}function R(t){t.preventDefault(),t.stopPropagation(),d.value&&F.value?l.value=!0:d.value=!0}function Q(){a("cancel"),d.value=!1,l.value=!1}function W(t){a("save",t),d.value=!1}function X(t){t==null&&(s.value=x())}function Z(t){e.updateOn.includes("blur")&&_(t.target),S(),F.value&&l.value&&!w.value&&(d.value=!1,l.value=!1)}function _(t){let{value:o}=t;if(!o.trim())s.value=x();else if(!e.multiple)g(o)&&(s.value=f(o));else{const v=o.trim().split(/\D+-\D+|[^\d\-/.]+/);v.every(g)&&(e.multiple==="range"?s.value=ee(v):s.value=v.map(f))}}function ee(t){const[o,v]=t.map(f).toSorted((p,B)=>r.isAfter(p,B)?1:-1),C=r.getDiff(v??o,o,"days");return[o,...Ve(C,1).map(p=>r.addDays(o,p))]}return fe(()=>{const t=N.filterProps(e),o=T.filterProps(M(e,["active","location","rounded"])),v=q.filterProps(M(e,["placeholder"]));return b(q,U({ref:c},v,{class:e.class,style:e.style,modelValue:Y.value,inputmode:z.value,placeholder:e.placeholder??k.value,readonly:G.value,onKeydown:I.value?H:void 0,focused:d.value||w.value,onFocus:O,onBlur:Z,validationValue:s.value,"onClick:control":I.value?R:void 0,"onClick:prepend":I.value?R:void 0,"onUpdate:modelValue":X}),{...u,default:()=>{var C;return b(De,null,[b(Pe,{modelValue:d.value,"onUpdate:modelValue":p=>d.value=p,activator:"parent","min-width":"0",eager:w.value,location:e.location,closeOnContentClick:!1,openOnClick:!1},{default:()=>[b(N,U(t,{modelValue:s.value,"onUpdate:modelValue":p=>s.value=p,disabled:m.value,onSave:W,onCancel:Q}),{default:p=>{let{actions:B,model:$,save:te,cancel:ae,isPristine:ne}=p;function re(y){e.hideActions?(s.value=y,e.multiple||(d.value=!1)):$.value=y,a("save",y),m.value=[]}return b(T,U(o,{modelValue:e.hideActions?s.value:$.value,"onUpdate:modelValue":y=>re(y),onMousedown:y=>y.preventDefault()}),{actions:e.hideActions?void 0:()=>{var y;return((y=u.actions)==null?void 0:y.call(u,{save:te,cancel:ae,isPristine:ne}))??B()}})}})]}),(C=u.default)==null?void 0:C.call(u)])}})}),me({},c)}}),Se={components:{VDateInput:Ae},props:{modelValue:{type:[Array,Date,String,null],default:null},config:{type:Object,default:()=>{}},assets:{type:Object,default:()=>{}},readonly:{type:Boolean,default:!1}},emits:["update:modelValue","error"],methods:{update(e){this.$emit("update:modelValue",e),this.validate()},async validate(){await this.$nextTick();const e=await this.$refs.field.validate();return this.$emit("error",e.length>0),!e.length}},watch:{modelValue:{immediate:!0,handler(e){this.validate()}}}};function Ie(e,n,a,u,i,h){const r=ke("v-date-input");return xe(),we(r,{ref:"field",rules:[g=>!a.config.required||!!g||"Value is required"],readonly:a.readonly,"allowed-dates":a.config.allowed,clearable:!a.readonly&&!a.config.required,max:a.config.max,min:a.config.min,multiple:a.config.multiple,placeholder:a.config.placeholder||null,modelValue:a.modelValue,"onUpdate:modelValue":n[0]||(n[0]=g=>h.update(g)),density:"comfortable","hide-details":"auto",variant:"outlined","show-adjacent-months":""},null,8,["rules","readonly","allowed-dates","clearable","max","min","multiple","placeholder","modelValue"])}const Ue=Fe(Se,[["render",Ie]]);export{Ue as default};
