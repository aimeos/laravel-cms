import{_ as se,aJ as de,b as M,w as s,aL as ce,o as h,a as v,aG as ve,aM as me,c as g,F as k,a1 as z,aH as K,f as fe,b8 as he,j as w,t as V,b9 as pe,ba as ge,ao as Ce,ap as H,aq as ye,ar as G,bb as we,d as x,bc as ee,bd as te,as as D,az as ne,a3 as re,be as _e,i as Ve}from"../index.js";const Te={props:{item:{type:Object,required:!0}},setup(){return{drawer:de()}},computed:{values(){const t={id:this.item.id,editor:this.item.editor};return this.item.created_at&&(t.created=new Date(this.item.created_at).toLocaleString()),this.item.updated_at&&(t.updated=new Date(this.item.updated_at).toLocaleString()),this.item.deleted_at&&(t.deleted=new Date(this.item.deleted_at).toLocaleString()),t}}};function Le(t,e,n,u,i,r){return h(),M(ce,{modelValue:u.drawer.aside,"onUpdate:modelValue":e[0]||(e[0]=a=>u.drawer.aside=a),"mobile-breakpoint":"md",location:"end"},{default:s(()=>[v(ve,{opened:[0]},{default:s(()=>[v(me,{value:0},{activator:s(({props:a})=>[v(K,pe(ge(a)),{default:s(()=>e[1]||(e[1]=[w("Meta data")])),_:2,__:[1]},1040)]),default:s(()=>[(h(!0),g(k,null,z(r.values,(a,l)=>(h(),M(K,{key:l,rounded:"lg"},{default:s(()=>[v(he,{class:"name"},{default:s(()=>[w(V(l),1)]),_:2},1024),fe("div",null,V(a),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])}const $e=se(Te,[["render",Le],["__scopeId","data-v-051f884b"]]);function C(){}C.prototype={diff:function(e,n){var u,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=i.callback;typeof i=="function"&&(r=i,i={});var a=this;function l(c){return c=a.postProcess(c,i),r?(setTimeout(function(){r(c)},0),!0):c}e=this.castInput(e,i),n=this.castInput(n,i),e=this.removeEmpty(this.tokenize(e,i)),n=this.removeEmpty(this.tokenize(n,i));var o=n.length,d=e.length,f=1,m=o+d;i.maxEditLength!=null&&(m=Math.min(m,i.maxEditLength));var T=(u=i.timeout)!==null&&u!==void 0?u:1/0,_=Date.now()+T,p=[{oldPos:-1,lastComponent:void 0}],y=this.extractCommon(p[0],n,e,0,i);if(p[0].oldPos+1>=d&&y+1>=o)return l(ue(a,p[0].lastComponent,n,e,a.useLongestToken));var I=-1/0,O=1/0;function $(){for(var c=Math.max(I,-f);c<=Math.min(O,f);c+=2){var L=void 0,q=p[c-1],N=p[c+1];q&&(p[c-1]=void 0);var b=!1;if(N){var W=N.oldPos-c;b=N&&0<=W&&W<o}var S=q&&q.oldPos+1<d;if(!b&&!S){p[c]=void 0;continue}if(!S||b&&q.oldPos<N.oldPos?L=a.addToPath(N,!0,!1,0,i):L=a.addToPath(q,!1,!0,1,i),y=a.extractCommon(L,n,e,c,i),L.oldPos+1>=d&&y+1>=o)return l(ue(a,L.lastComponent,n,e,a.useLongestToken));p[c]=L,L.oldPos+1>=d&&(O=Math.min(O,c-1)),y+1>=o&&(I=Math.max(I,c+1))}f++}if(r)(function c(){setTimeout(function(){if(f>m||Date.now()>_)return r();$()||c()},0)})();else for(;f<=m&&Date.now()<=_;){var J=$();if(J)return J}},addToPath:function(e,n,u,i,r){var a=e.lastComponent;return a&&!r.oneChangePerToken&&a.added===n&&a.removed===u?{oldPos:e.oldPos+i,lastComponent:{count:a.count+1,added:n,removed:u,previousComponent:a.previousComponent}}:{oldPos:e.oldPos+i,lastComponent:{count:1,added:n,removed:u,previousComponent:a}}},extractCommon:function(e,n,u,i,r){for(var a=n.length,l=u.length,o=e.oldPos,d=o-i,f=0;d+1<a&&o+1<l&&this.equals(u[o+1],n[d+1],r);)d++,o++,f++,r.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return f&&!r.oneChangePerToken&&(e.lastComponent={count:f,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=o,d},equals:function(e,n,u){return u.comparator?u.comparator(e,n):e===n||u.ignoreCase&&e.toLowerCase()===n.toLowerCase()},removeEmpty:function(e){for(var n=[],u=0;u<e.length;u++)e[u]&&n.push(e[u]);return n},castInput:function(e){return e},tokenize:function(e){return Array.from(e)},join:function(e){return e.join("")},postProcess:function(e){return e}};function ue(t,e,n,u,i){for(var r=[],a;e;)r.push(e),a=e.previousComponent,delete e.previousComponent,e=a;r.reverse();for(var l=0,o=r.length,d=0,f=0;l<o;l++){var m=r[l];if(m.removed)m.value=t.join(u.slice(f,f+m.count)),f+=m.count;else{if(!m.added&&i){var T=n.slice(d,d+m.count);T=T.map(function(_,p){var y=u[f+p];return y.length>_.length?y:_}),m.value=t.join(T)}else m.value=t.join(n.slice(d,d+m.count));d+=m.count,m.added||(f+=m.count)}}return r}function ae(t,e){var n;for(n=0;n<t.length&&n<e.length;n++)if(t[n]!=e[n])return t.slice(0,n);return t.slice(0,n)}function ie(t,e){var n;if(!t||!e||t[t.length-1]!=e[e.length-1])return"";for(n=0;n<t.length&&n<e.length;n++)if(t[t.length-(n+1)]!=e[e.length-(n+1)])return t.slice(-n);return t.slice(-n)}function U(t,e,n){if(t.slice(0,e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't start with prefix ").concat(JSON.stringify(e),"; this is a bug"));return n+t.slice(e.length)}function Z(t,e,n){if(!e)return t+n;if(t.slice(-e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't end with suffix ").concat(JSON.stringify(e),"; this is a bug"));return t.slice(0,-e.length)+n}function A(t,e){return U(t,e,"")}function R(t,e){return Z(t,e,"")}function oe(t,e){return e.slice(0,De(t,e))}function De(t,e){var n=0;t.length>e.length&&(n=t.length-e.length);var u=e.length;t.length<e.length&&(u=t.length);var i=Array(u),r=0;i[0]=0;for(var a=1;a<u;a++){for(e[a]==e[r]?i[a]=i[r]:i[a]=r;r>0&&e[a]!=e[r];)r=i[r];e[a]==e[r]&&r++}r=0;for(var l=n;l<t.length;l++){for(;r>0&&t[l]!=e[r];)r=i[r];t[l]==e[r]&&r++}return r}var B="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",ke=new RegExp("[".concat(B,"]+|\\s+|[^").concat(B,"]"),"ug"),F=new C;F.equals=function(t,e,n){return n.ignoreCase&&(t=t.toLowerCase(),e=e.toLowerCase()),t.trim()===e.trim()};F.tokenize=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n;if(e.intlSegmenter){if(e.intlSegmenter.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');n=Array.from(e.intlSegmenter.segment(t),function(r){return r.segment})}else n=t.match(ke)||[];var u=[],i=null;return n.forEach(function(r){/\s/.test(r)?i==null?u.push(r):u.push(u.pop()+r):/\s/.test(i)?u[u.length-1]==i?u.push(u.pop()+r):u.push(i+r):u.push(r),i=r}),u};F.join=function(t){return t.map(function(e,n){return n==0?e:e.replace(/^\s+/,"")}).join("")};F.postProcess=function(t,e){if(!t||e.oneChangePerToken)return t;var n=null,u=null,i=null;return t.forEach(function(r){r.added?u=r:r.removed?i=r:((u||i)&&le(n,i,u,r),n=r,u=null,i=null)}),(u||i)&&le(n,i,u,null),t};function le(t,e,n,u){if(e&&n){var i=e.value.match(/^\s*/)[0],r=e.value.match(/\s*$/)[0],a=n.value.match(/^\s*/)[0],l=n.value.match(/\s*$/)[0];if(t){var o=ae(i,a);t.value=Z(t.value,a,o),e.value=A(e.value,o),n.value=A(n.value,o)}if(u){var d=ie(r,l);u.value=U(u.value,l,d),e.value=R(e.value,d),n.value=R(n.value,d)}}else if(n)t&&(n.value=n.value.replace(/^\s*/,"")),u&&(u.value=u.value.replace(/^\s*/,""));else if(t&&u){var f=u.value.match(/^\s*/)[0],m=e.value.match(/^\s*/)[0],T=e.value.match(/\s*$/)[0],_=ae(f,m);e.value=A(e.value,_);var p=ie(A(f,_),T);e.value=R(e.value,p),u.value=U(u.value,f,p),t.value=Z(t.value,f,f.slice(0,f.length-p.length))}else if(u){var y=u.value.match(/^\s*/)[0],I=e.value.match(/\s*$/)[0],O=oe(I,y);e.value=R(e.value,O)}else if(t){var $=t.value.match(/\s*$/)[0],J=e.value.match(/^\s*/)[0],c=oe($,J);e.value=A(e.value,c)}}var ze=new C;ze.tokenize=function(t){var e=new RegExp("(\\r?\\n)|[".concat(B,"]+|[^\\S\\n\\r]+|[^").concat(B,"]"),"ug");return t.match(e)||[]};var j=new C;j.tokenize=function(t,e){e.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));var n=[],u=t.split(/(\n|\r\n)/);u[u.length-1]||u.pop();for(var i=0;i<u.length;i++){var r=u[i];i%2&&!e.newlineIsToken?n[n.length-1]+=r:n.push(r)}return n};j.equals=function(t,e,n){return n.ignoreWhitespace?((!n.newlineIsToken||!t.includes(`
`))&&(t=t.trim()),(!n.newlineIsToken||!e.includes(`
`))&&(e=e.trim())):n.ignoreNewlineAtEof&&!n.newlineIsToken&&(t.endsWith(`
`)&&(t=t.slice(0,-1)),e.endsWith(`
`)&&(e=e.slice(0,-1))),C.prototype.equals.call(this,t,e,n)};var Ee=new C;Ee.tokenize=function(t){return t.split(/(\S.+?[.!?])(?=\s+|$)/)};var Ie=new C;Ie.tokenize=function(t){return t.split(/([{}:;,]|\s+)/)};function Q(t){"@babel/helpers - typeof";return Q=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Q(t)}var E=new C;E.useLongestToken=!0;E.tokenize=j.tokenize;E.castInput=function(t,e){var n=e.undefinedReplacement,u=e.stringifyReplacer,i=u===void 0?function(r,a){return typeof a>"u"?n:a}:u;return typeof t=="string"?t:JSON.stringify(X(t,null,null,i),i,"  ")};E.equals=function(t,e,n){return C.prototype.equals.call(E,t.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"),n)};function P(t,e,n){return E.diff(t,e,n)}function X(t,e,n,u,i){e=e||[],n=n||[],u&&(t=u(i,t));var r;for(r=0;r<e.length;r+=1)if(e[r]===t)return n[r];var a;if(Object.prototype.toString.call(t)==="[object Array]"){for(e.push(t),a=new Array(t.length),n.push(a),r=0;r<t.length;r+=1)a[r]=X(t[r],e,n,u,i);return e.pop(),n.pop(),a}if(t&&t.toJSON&&(t=t.toJSON()),Q(t)==="object"&&t!==null){e.push(t),a={},n.push(a);var l=[],o;for(o in t)Object.prototype.hasOwnProperty.call(t,o)&&l.push(o);for(l.sort(),r=0;r<l.length;r+=1)o=l[r],a[o]=X(t[o],e,n,u,o);e.pop(),n.pop()}else a=t;return a}var Y=new C;Y.tokenize=function(t){return t.slice()};Y.join=Y.removeEmpty=function(t){return t};const Oe={props:{modelValue:{type:Boolean,required:!0},current:{type:Object,required:!0},load:{type:Function,required:!0}},emit:["update:modelValue","use","revert"],data:()=>({list:[],show:!1}),mounted(){this.load().then(t=>{this.list=t})},computed:{versions(){return this.list.filter(t=>this.isModified(t,this.current)||t.published||t.publish_at)}},methods:{diff(t,e){return t&&e?P(t,e):e?[e]:[]},isModified(t,e){return!t||!e?!1:P(t.data||{},e.data||{}).length!==1||P(t.contents||{},e.contents||{}).length!==1}}},qe={key:0,class:"divider"},Ne=["onClick"],xe={key:0,class:"divider"};function Ae(t,e,n,u,i,r){return h(),M(Ce,{modelValue:n.modelValue,"max-width":"1200",scrollable:""},{default:s(()=>[v(H,{"prepend-icon":"mdi-history"},{append:s(()=>[v(Ve,{onClick:e[0]||(e[0]=a=>t.$emit("update:modelValue",!1))},{default:s(()=>e[3]||(e[3]=[w("mdi-close")])),_:1,__:[3]})]),title:s(()=>e[4]||(e[4]=[w(" History ")])),default:s(()=>[v(ye),v(G,null,{default:s(()=>[v(we,{side:"end",align:"start"},{default:s(()=>[r.isModified(t.list[0],n.current)?(h(),M(ee,{key:0,size:"small","dot-color":"blue"},{default:s(()=>[v(H,{class:"elevation-2",onClick:e[2]||(e[2]=a=>t.show=!t.show)},{default:s(()=>[v(te,null,{default:s(()=>e[5]||(e[5]=[w("Current")])),_:1,__:[5]}),v(G,{class:D(["diff",{show:t.show}])},{default:s(()=>{var a,l;return[(h(!0),g(k,null,z(r.diff((a=t.list[0])==null?void 0:a.data,n.current.data),o=>(h(),g("span",{class:D({added:o.added,removed:o.removed})},V(o.value||o),3))),256)),n.current.contents?(h(),g("div",qe,"Content:")):x("",!0),n.current.contents?(h(!0),g(k,{key:1},z(r.diff((l=t.list[0])==null?void 0:l.contents,n.current.contents),o=>(h(),g("span",{class:D({added:o.added,removed:o.removed})},V(o.value||o),3))),256)):x("",!0)]}),_:1},8,["class"]),v(ne,null,{default:s(()=>[v(re,{variant:"outlined",onClick:e[1]||(e[1]=a=>t.$emit("revert",t.list[0]))},{default:s(()=>e[6]||(e[6]=[w(" Revert ")])),_:1,__:[6]})]),_:1})]),_:1})]),_:1})):x("",!0),(h(!0),g(k,null,z(r.versions,(a,l)=>(h(),M(ee,{key:l,size:"small","dot-color":a.published?"success":"grey-lighten-1",class:D({publish:a.publish_at})},{default:s(()=>[v(H,{class:"elevation-2"},{default:s(()=>[fe("div",{onClick:o=>a._show=!a._show},[v(te,null,{default:s(()=>[w(V(new Date(a.publish_at||a.created_at).toLocaleString()),1)]),_:2},1024),v(_e,null,{default:s(()=>[w(V(a.editor),1)]),_:2},1024),v(G,{class:D(["diff",{show:a._show}])},{default:s(()=>[(h(!0),g(k,null,z(r.diff(a.data,n.current.data),o=>(h(),g("span",{class:D({added:o.removed,removed:o.added})},V(o.value||o),3))),256)),a.contents?(h(),g("div",xe,"Content:")):x("",!0),a.contents?(h(!0),g(k,{key:1},z(r.diff(a.contents,n.current.contents),o=>(h(),g("span",{class:D({added:o.removed,removed:o.added})},V(o.value||o),3))),256)):x("",!0)]),_:2},1032,["class"])],8,Ne),v(ne,null,{default:s(()=>[v(re,{variant:"outlined",onClick:o=>t.$emit("use",a)},{default:s(()=>e[7]||(e[7]=[w(" Use version ")])),_:2,__:[7]},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["dot-color","class"]))),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}const Je=se(Oe,[["render",Ae],["__scopeId","data-v-f1167c16"]]);export{$e as A,Je as H};
