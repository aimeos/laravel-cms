import{_ as f,c as p,a as r,w as l,as as n,h,at as g,au as w,F as V,av as o,an as v,$ as y,o as b,ap as C,ar as S,aw as F,D as u,i as c,j as t,t as k,ax as A,ay as q,az as M,a3 as U}from"../index.js";const $={data:()=>({creds:{email:"",password:""},form:null,error:null,loading:!1,login:!1,show:!1}),setup(){const e=v();return{auth:y(),message:e}},created(){this.auth.isAuthenticated().then(e=>{if(!e)throw e;o.replace(this.next())}).catch(e=>{this.login=!0})},methods:{cmslogin(){if(!this.creds.email||!this.creds.password)return!1;this.error=null,this.loading=!0,this.auth.login(this.creds.email,this.creds.password).then(e=>{e.cmseditor?o.replace(this.next()):this.error="Not a CMS editor"}).catch(e=>{this.error=e.message}).finally(()=>{this.loading=!1})},next(){var s;const e=this.auth.intended()||((s=o.getRoutes().find(i=>this.auth.can(i.name)))==null?void 0:s.path);return e||this.message.add("Access denied","error"),e||"/"}}};function B(e,s,i,d,D,m){return b(),p(V,null,[r(g,{class:n(["login",{show:e.login}]),modelValue:e.form,"onUpdate:modelValue":s[4]||(s[4]=a=>e.form=a),onSubmit:s[5]||(s[5]=h(a=>m.cmslogin(),["prevent"]))},{default:l(()=>[r(C,{loading:e.loading,class:n(["elevation-2",{error:e.error}])},{title:l(()=>s[7]||(s[7]=[t(" Login ")])),default:l(()=>[r(S,null,{default:l(()=>[r(u,{modelValue:e.creds.email,"onUpdate:modelValue":s[0]||(s[0]=a=>e.creds.email=a),label:"E-Mail",variant:"underlined","validate-on":"blur",rules:[a=>!!a||"Field is required",a=>!!a.match(/.+@.+/)||"Invalid e-mail address"],autocomplete:"username",autofocus:""},null,8,["modelValue","rules"]),r(u,{modelValue:e.creds.password,"onUpdate:modelValue":s[3]||(s[3]=a=>e.creds.password=a),type:e.show?"text":"password",label:"Password",variant:"underlined",rules:[a=>!!a||"Field is required"],autocomplete:"current-password"},{"append-inner":l(()=>[r(c,{onClick:s[1]||(s[1]=a=>e.show=!e.show),onKeydown:s[2]||(s[2]=a=>[13,32].includes(a.keyCode)?e.show=!e.show:!1)},{default:l(()=>[t(k(e.show?"mdi-eye-off":"mdi-eye"),1)]),_:1})]),_:1},8,["modelValue","type","rules"]),F(r(A,{color:"error",icon:"mdi-alert-octagon",text:"Error: "+e.error},null,8,["text"]),[[q,e.error]])]),_:1}),r(M,null,{default:l(()=>[r(U,{type:"submit",variant:"outlined",disabled:e.form!=!0},{default:l(()=>s[8]||(s[8]=[t("Login")])),_:1,__:[8]},8,["disabled"])]),_:1})]),_:1},8,["loading","class"])]),_:1},8,["class","modelValue"]),r(w,{modelValue:d.message.queue,"onUpdate:modelValue":s[6]||(s[6]=a=>d.message.queue=a)},null,8,["modelValue"])],64)}const L=f($,[["render",B]]);export{L as default};
